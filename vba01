Sub CreateChartDynamic()
    Dim ws As Worksheet
    Dim chObj As ChartObject
    Dim lastChart As Chart
    
    ' 当前活动的工作表
    Set ws = ActiveSheet
    
    ' B列～D列的所有数据
    Columns("B:D").Select
    
    ' 插入散布图（直线无标记）
    Set chObj = ws.ChartObjects.Add(Left:=100, Top:=50, Width:=400, Height:=300)
    
    ' 获取刚刚创建的最新图表
    Set lastChart = chObj.Chart
    
    ' 设置数据范围
    lastChart.SetSourceData Source:=ws.Range("B8:B50")
    
    ' 设置图表类型为散布图（直线无标记）
    lastChart.ChartType = xlXYScatterLinesNoMarkers
    
    ' 设置 Y 轴最大值为 100
    lastChart.Axes(xlValue).MaximumScale = 100
    
    ' 设置 X 轴（横轴）数据格式
    lastChart.Axes(xlCategory).TickLabels.NumberFormatLocal = "m/d/yyyy"
    
    ' 设置图表标题
    lastChart.HasTitle = True
    lastChart.ChartTitle.Text = "PCの使用率"
    
    ' 提示操作完成
    MsgBox "グラフが作成されました！", vbInformation, "完了"

End Sub
